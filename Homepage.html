<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Hobby Finder Inc.</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v3.2.0/mapbox-gl.js"></script>
    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.min.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v5.0.0/mapbox-gl-geocoder.css" type="text/css">
    <link rel="stylesheet" href="style.css">
    <script src="autocomplete.js"></script>
    <style>
    </style>
</head>
<body>
    <header class="header">
        <h1>Hobby Finder Inc.</h1>
    </header>
    <div class="container">
        <form id="search_form" action="/search-hobbies" method="get" class="search-bar" >
            <div id="suggestions-dropdown" style="display:none;"></div>
            <input type="text" placeholder="Search hobbies..." name="q" />
            <button type="submit"><img src="images/search.png" /></button>
        </form>
        <br>
        <form action="/search-hobbies" method="post" class="search-bar">
            <input form="search_form" type="text" id="my-location-input" placeholder="Location" name="l" />
            <input form="search_form" type="date" placeholder="MM/DD/YY" name="date" />
        </form>

    </div>
<script>
document.addEventListener('DOMContentLoaded', function() {
    const searchForm = document.getElementById('search_form');

    searchForm.addEventListener('submit', function(e) {
        e.preventDefault(); // Prevent the default form submission

        // Fetch user inputs from the form
        const query = document.querySelector('input[name="q"]').value;
        const location = document.querySelector('input[name="l"]').value;
        const date = document.querySelector('input[name="date"]').value;

        fetchDataAndRedirect(query, location, date);
    });
});

function fetchDataAndRedirect(query, location, date) {
    fetch(`/search-hobbies?q=${encodeURIComponent(query)}&l=${encodeURIComponent(location)}&date=${encodeURIComponent(date)}`)
        .then(response => response.json())
        .then(data => {
            localStorage.setItem('formattedData', JSON.stringify(data));
            window.location.href = 'ResultsPage.html'; // Redirect to the results page
        })
        .catch(error => console.error('Error:', error));
}
</script>

</body>
</html>
